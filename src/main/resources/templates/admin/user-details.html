<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>사용자 상세 정보</title>
</head>
<body>
    <div th:if="${param.error}" class="alert alert-danger" role="alert">
        <p th:text="${param.error}"></p>
    </div>
    <h1>사용자 상세 정보</h1>
    <div th:object="${user}">
        <p>사용자명: <span th:text="*{username}"></span></p>
        <p>이름: <span th:text="*{name}"></span></p>
        <p>이메일: <span th:text="*{email}"></span></p>
        <p>역할: <span th:text="*{role}"></span></p>
    </div>

    <h2>게시물</h2>
    <ul>
        <li th:each="post : ${posts}">
            <span th:text="${post.title}"></span>
            <span th:text="${post.content}"></span>
            <form th:action="@{/admin/post/{id}/delete(id=${post.id})}" method="post">
                <input type="hidden" name="userId" th:value="${user.id}" />
                <button type="submit">삭제</button>
            </form>
        </li>
    </ul>
    <p th:if="${#lists.isEmpty(posts)}">게시물이 없습니다.</p>
    <form th:action="@{/admin/user/{id}/delete-posts(id=${user.id})}" method="post">
        <button type="submit">모든 게시물 삭제</button>
    </form>

    <h2>일정</h2>
    <ul>
        <li th:each="event : ${events}">
            <span th:text="${event.title}"></span>
            <form th:action="@{/admin/event/{id}/delete(id=${event.id})}" method="post">
                <button type="submit">삭제</button>
            </form>
        </li>
    </ul>
    <form th:action="@{/admin/user/{id}/delete-events(id=${user.id})}" method="post">
        <button type="submit">모든 일정 삭제</button>
    </form>

    <h2>역할 변경</h2>
    <form th:action="@{/admin/user/{id}/update-role(id=${user.id})}" method="post">
        <select name="role">
            <option th:each="role : ${roles}" th:value="${role}" th:text="${role}"></option>
        </select>
        <button type="submit">역할 변경</button>
    </form>

    <form th:action="@{/admin/user/{id}/delete(id=${user.id})}" method="post">
        <button type="submit">사용자 삭제</button>
    </form>
</body>
</html>
